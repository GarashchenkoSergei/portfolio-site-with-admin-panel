(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{560:function(t,e,i){},561:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var a=i(107);const n=t=>{return`${a.a.defaults.baseURL}/${t}`}},562:function(t,e,i){"use strict";var a=i(560);i.n(a).a},563:function(t,e,i){},567:function(t,e,i){"use strict";var a=function(){var t=this.$createElement;return(this._self._c||t)("button",{staticClass:"btn-styled",attrs:{type:this.type}},[this._v(this._s(this.title))])};a._withStripped=!0;var n={props:{title:String,type:String}},s=(i(562),i(3)),r=Object(s.a)(n,a,[],!1,null,"1bfc0524",null);r.options.__file="src/admin/components/app-button.vue";e.a=r.exports},568:function(t,e,i){"use strict";var a=i(563);i.n(a).a},573:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-feedback__new"},[i("h5",{staticClass:"content__new-title"},[t._v(t._s(t.title))]),i("div",{staticClass:"content-feedback__new-content"},[i("label",{staticClass:"new-content__picture"},[i("input",{staticClass:"reviews__form-file-input",attrs:{type:"file"},on:{change:t.appendFileAndRenderPhoto}}),i("div",{staticClass:"new-content__picture-pic"},[i("div",{staticClass:"feedback__pic",class:{filled:this.rendedPhotoUrl.length},style:{backgroundImage:"url("+this.rendedPhotoUrl+")"}})]),i("div",{staticClass:"new-content__picture-text"},[t._v("Добавить фото")])]),i("form",{staticClass:"new-content__info",attrs:{action:""}},[i("div",{staticClass:"new-content__info-author"},[i("app-input",{staticClass:"info-author",attrs:{type:"text",title:"Author's name",placeholder:"Bruce Wayne"},model:{value:t.review.author,callback:function(e){t.$set(t.review,"author",e)},expression:"review.author"}}),i("app-input",{staticClass:"info-author",attrs:{type:"text",title:"Author's title",placeholder:"Batman"},model:{value:t.review.occ,callback:function(e){t.$set(t.review,"occ",e)},expression:"review.occ"}})],1),i("div",{staticClass:"new-content__info-text"},[i("app-input",{staticClass:"info-text",attrs:{title:"Feedback","field-type":"textarea"},model:{value:t.review.text,callback:function(e){t.$set(t.review,"text",e)},expression:"review.text"}})],1),i("div",{staticClass:"new-content__info-buttons"},[i("button",{staticClass:"button-cancel",attrs:{type:"reset"},on:{click:t.closeForm}},[t._v("Cancel")]),i("button",{staticClass:"save",attrs:{type:"submit"},on:{click:function(e){"add"===t.mode?t.addReview():t.editCurrentReview()}}},[t._v("Save")])])])])])};a._withStripped=!0;var n=i(15),s=i(561),r=i(66),o=i(567),c={props:{title:{type:String,default:"New review"},mode:{type:String,default:"add"}},components:{appInput:r.a,appButton:o.a},data:()=>({rendedPhotoUrl:"",review:{id:0,author:"",occ:"",text:"",photo:""}}),computed:{...Object(n.d)("feedback",{currentReview:t=>t.currentReview}),userAvatarUrl(){return`url(${this.rendedPhotoUrl})`}},watch:{currentReview(t){"edit"===this.mode&&this.fillFormWithCurrentReviewData()}},created(){"edit"===this.mode&&this.fillFormWithCurrentReviewData()},methods:{...Object(n.b)("feedback",["addNewReview","updateReview"]),appendFileAndRenderPhoto(t){const e=t.target.files[0];this.review.photo=e;const i=new FileReader;try{i.readAsDataURL(e),i.onload=()=>{this.rendedPhotoUrl=i.result}}catch(t){alert("щляпа")}},async addReview(){const t=new FormData;t.append("author",this.review.author),t.append("occ",this.review.occ),t.append("text",this.review.text),t.append("photo",this.review.photo);try{await this.addNewReview(t),this.clearFormFields()}catch(t){alert(t),console.log("шляпа при добавлении нового")}},async editCurrentReview(){try{await this.updateReview(this.review);this.$emit("cancel")}catch(t){alert("шляпа в редактировании")}},closeForm(){this.review={},this.$emit("cancel")},clearFormFields(){this.review={},this.rendedPhotoUrl=""},fillFormWithCurrentReviewData(){this.review={...this.currentReview},this.rendedPhotoUrl=Object(s.a)(this.currentReview.photo)}}},l=(i(568),i(3)),d=Object(l.a)(c,a,[],!1,null,"1c9e5e2c",null);d.options.__file="src/admin/components/feedback-form.vue";e.default=d.exports}}]);